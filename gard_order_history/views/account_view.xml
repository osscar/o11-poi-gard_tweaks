<?xml version="1.0"?>
<openerp>
    <data>
        <!-- Search Views -->

        <!-- Views -->
        <!-- <record id="view_account_move_line_kanban" model="ir.ui.view">
            <field name="name">account.move.line.kanban</field>
            <field name="model">account.move.line</field>
            <field name="arch" type="xml">
                <kanban class="o_kanban_mobile" default_group_by="account_id">
                    <field name="account_id"/>
                    <field name="date"/>
                    <field name="ref"/>
                    <field name="debit"/>
                    <field name="credit"/>
                    <templates>
                        <t t-name="kanban-box">
                            <div t-attf-class="oe_kanban_global_click">
                                <div class="row mb4">
                                    <div class="col-xs-6">
                                        <strong><span><field name="account_id"/></span></strong>
                                    </div>
                                    <div class="col-xs-6 text-right">
                                        <strong><i class="fa fa-clock-o"/> <t t-esc="record.date.value"/></strong>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-xs-12">
                                        <span><field name="ref"/></span>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-xs-6">
                                        <span><field name="amount" widget='monetary'/></span>
                                        <span><field name="currency_id" invisible="1"/></span>
                                    </div>
                                    <div class="col-xs-6">
                                        <span class="pull-right">
                                            <field name="state" widget="label_selection" options="{'classes': {'draft': 'default', 'posted': 'success'}}"/>
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record> -->

        <record id="invoice_tree" model="ir.ui.view">
            <field name="name">invoice.tree.inherit.gard_order_history</field>
            <field name="model">account.invoice</field>
            <field name="mode">extension</field>
            <field name="inherit_id" ref="account.invoice_tree"/>
            <field name="arch" type="xml">

                <xpath expr="//tree" position="attributes">
                    <attribute name="decoration-danger">(state in 'open') and (residual_signed &gt; 0) and (date_due &lt; current_date)</attribute>
                    <attribute name="decoration-danger">state not in ('paid','cancel') and estado_fac in 'A'</attribute>
                    <attribute name="decoration-success">state in 'paid' and estado_fac in 'V'</attribute>
                </xpath>

                <xpath expr="//tree/field[@name='state']" position="attributes">
                    <attribute name="widget">label_selection</attribute>
                    <attribute name="options">{
                        'classes': {
                            'draft': 'primary',
                            'none': 'danger',
                            'open': 'warning',
                            'paid': 'success',
                            'cancel': 'default'
                            }
                    }</attribute>
                </xpath>

                <xpath expr="//tree/field[@name='estado_fac']" position="attributes">
                    <attribute name="options">{
                        "bg_color": "
                            silver: state in 'paid' and estado_fac in 'A';
                            lightcoral: state not in ('paid','cancel') and estado_fac in 'A'
                            "
                    }</attribute>
                </xpath>

                <xpath expr="//tree/field[@name='residual_signed']" position="attributes">
                    <attribute name="options">{
                        "bg_color": "
                            lightcoral: (state in 'open') and (residual_signed &gt; 0) and (date_due &lt; current_date)
                            "
                    }</attribute>
                </xpath>

            </field>
        </record>

        <record id="invoice_supplier_tree" model="ir.ui.view">
            <field name="name">invoice.supplier.tree.inherit.gard_order_history</field>
            <field name="model">account.invoice</field>
            <field name="mode">extension</field>
            <field name="inherit_id" ref="account.invoice_supplier_tree"/>
            <field name="arch" type="xml">

                <xpath expr="//tree/field[@name='state']" position="after">
                    <field name="estado_fac"/>
                </xpath>

                <xpath expr="//tree" position="attributes">
                    <attribute name="decoration-danger">(state in 'open') and (residual_signed &gt; 0) and (date_due &lt; current_date)</attribute>
                    <attribute name="decoration-danger">state not in ('paid','cancel') and estado_fac in 'A'</attribute>
                    <attribute name="decoration-success">state in 'paid' and estado_fac in 'V'</attribute>
                </xpath>

                <xpath expr="//tree/field[@name='state']" position="attributes">
                    <attribute name="widget">label_selection</attribute>
                    <attribute name="options">{
                        'classes': {
                            'draft': 'primary',
                            'none': 'danger',
                            'open': 'warning',
                            'paid': 'success',
                            'cancel': 'default'
                            },
                    }</attribute>

                </xpath>

                <xpath expr="//tree/field[@name='estado_fac']" position="attributes">
                    <attribute name="options">{
                        "bg_color": "
                            silver: state in 'paid' and estado_fac in 'A';
                            lightcoral: state not in ('paid','cancel') and estado_fac in 'A'
                            "
                    }</attribute>
                </xpath>

                <xpath expr="//tree/field[@name='residual_signed']" position="attributes">
                    <attribute name="options">{
                        "bg_color": "
                            lightcoral: (state in 'open') and (residual_signed &gt; 0) and (date_due &lt; current_date)
                            "
                    }</attribute>
                </xpath>

            </field>
        </record>

        <record id="view_invoice_tree" model="ir.ui.view">
            <field name="name">account.invoice.tree.gard_order_history</field>
            <field name="model">account.invoice</field>
            <field name="view_mode">tree</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">

                <tree decoration-danger="state in 'open' and (residual_signed &gt; 0) and date_due &lt; current_date" decoration-success="state == 'paid'" string="Invoices">
                    <field name="currency_id" invisible="1"/>
                    <field name="state" widget="label_selection"
                        options="{
                            'classes': {
                                'draft': 'primary',
                                'none': 'danger',
                                'open': 'warning',
                                'paid': 'success',
                                'cancel': 'default'
                                }}"/>
                    <field name="estado_fac"/>
                    <field name="date_due"/>
                    <field name="date_invoice"/>
                    <field name="number"/>
                    <field name="cc_nro"/>
                    <field name="origin"/>
                    <field name="partner_id"/>
                    <field name="residual_signed"/>
                    <field name="amount_total_signed"/>
                    <field name="payment_ids" widget="many2many_tags"/>
                </tree>
                <!-- <kanban class="o_kanban_mobile">
                    <field name="currency_id" invisible="1"/>
                    <field name="state"/>
                    <field name="estado_fac"/>
                    <field name="date_due"/>
                    <field name="date_invoice"/>
                    <field name="number"/>
                    <field name="cc_nro"/>
                    <field name="origin"/>
                    <field name="partner_id"/>
                    <field name="residual_signed"/>
                    <field name="amount_total_signed"/>
                    <field name="payment_ids"/>
                    <templates>
                    <t t-name="kanban-box">
                        <div t-attf-class="oe_kanban_card oe_kanban_global_click">
                            <div class="row">
                                <div class="col-xs-6">
                                    <strong><span><t t-esc="record.partner_id.value"/></span></strong>
                                </div>
                                <div class="col-xs-6 pull-right text-right">
                                    <i class="fa fa-clock-o"/> <b><field name="date_invoice"/></b>
                                    <br/>
                                    <i class="fa fa-money"/> <field name="amount_total_signed" widget="monetary"/>
                                    <br/>
                                    <strong><field name="residual_signed" widget="monetary"/></strong>
                                    <div class="o_kanban_tags_section">
                                        <field name="payment_ids"/>
                                    </div>
                                </div>
                                <br/>
                                <div class="col-xs-6">
                                    <t t-if="record.partner_invoice_id.value"> <field name="partner_invoice_id"/> </t>
                                </div>
                                <br/>
                                <br/>
                                <div class="col-xs-6">
                                    <span><b><t t-esc="record.origin.value"/></b></span>
                                </div>
                            </div>
                            <div class="row">

                            </div>
                            <div class="row">
                                <div class="col-xs-6">
                                    <span><b>
                                        <b><t t-esc="record.number.value"/></b>
                                    <br/>
                                    [<t t-esc="record.cc_nro.raw_value"/>]
                                </b></span>
                                    <br/>
                                </div>
                                <div class="col-xs-6 pull-right text-right">
                                    <span>
                                        <field name="estado_fac" widget="kanban_label_selection"
                                            options="{'classes': {'V': 'success', 'A': 'default', 'na': 'default', 'N': 'default',
                                                'E': 'danger', 'C': 'warning'}}"/>
                                        <field name="state" widget="kanban_label_selection"
                                            options="{'classes': {'draft': 'default', 'cancel': 'default', 'none': 'danger',
                                                'proforma': 'warning', 'proforma2': 'warning', 'open': 'warning', 'paid': 'success'}}"/>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </t>
                    </templates>
                </kanban> -->

            </field>
        </record>

        <!-- <record id="view_invoice_kanban" model="ir.ui.view">
            <field name="name">account.invoice.kanban.gard_order_history</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">

                <kanban class="o_kanban_mobile">
                    <field name="currency_id" invisible="1"/>
                    <field name="state"/>
                    <field name="estado_fac"/>
                    <field name="date_due"/>
                    <field name="date_invoice"/>
                    <field name="number"/>
                    <field name="cc_nro"/>
                    <field name="origin"/>
                    <field name="partner_id"/>
                    <field name="residual_signed"/>
                    <field name="amount_total_signed"/>
                    <field name="payment_ids"/>
                    <templates>
                    <t t-name="kanban-box">
                        <div t-attf-class="oe_kanban_card oe_kanban_global_click">
                            <div class="row">
                                <div class="col-xs-6">
                                    <strong><span><t t-esc="record.partner_id.value"/></span></strong>
                                </div>
                                <div class="col-xs-6 pull-right text-right">
                                    <field name="amount_total_signed" widget="monetary"/>
                                <br/>
                                    <strong><field name="residual_signed" widget="monetary"/></strong>
                                </div>
                                <br/>
                                <div class="col-xs-6">
                                    <t t-if="record.partner_invoice_id.value"> <field name="partner_invoice_id"/> </t>
                                </div>
                                <div class="col-xs-6 pull-right text-right text-muted">
                                    <span><t t-esc="record.origin.value"/></span>
                                </div>
                            </div>
                            <div class="row">

                            </div>
                            <div class="row">
                                <div class="col-xs-6 pull-right text-right text-muted">
                                    <span><t t-esc="record.number.value"/>
                                    <br/>
                                    <b>[<t t-esc="record.cc_nro.raw_value"/>] <t t-esc="record.date_invoice.value"/></b></span>
                                    <br/>
                                    <span>
                                        <field name="estado_fac" widget="kanban_label_selection" options="{'classes': {'V': 'success', 'A': 'default', 'na': 'default', 'N': 'default', 'E': 'danger', 'C': 'warning'}}"/>
                                        <field name="state" widget="kanban_label_selection" options="{'classes': {'draft': 'default', 'cancel': 'default', 'none': 'danger', 'proforma': 'warning', 'proforma2': 'warning', 'open': 'warning',
                                        'paid': 'success'}}"/>
                                    </span>
                                </div>
                                <div class="col-xs-6 pull-right text-right">

                                </div>
                            </div>
                        </div>
                    </t>
                    </templates>
                </kanban>

            </field>
        </record> -->

        <!-- TO DO: had to inherit custom view to xpath and extend options' attributes to colorize fields -->
        <!-- optimally this should be added in primary view -->
        <!-- but the JSON syntax doesn't bode well with conditions against field values -->
        <record id="view_invoice_tree_inherit" model="ir.ui.view">
            <field name="name">invoice.tree.inherit.gard_order_history</field>
            <field name="model">account.invoice</field>
            <field name="mode">extension</field>
            <field name="inherit_id" ref="gard_order_history.view_invoice_tree"/>
            <field name="arch" type="xml">

                <xpath expr="//tree/field[@name='estado_fac']" position="attributes">
                    <attribute name="options">{
                        "bg_color": "
                            silver: state in 'paid' and estado_fac in 'A';
                            lightcoral: state not in ('paid','cancel') and estado_fac in 'A'
                            "
                    }</attribute>
                </xpath>

                <xpath expr="//tree/field[@name='residual_signed']" position="attributes">
                    <attribute name="options">{
                        "bg_color": "
                            lightcoral: (state in 'open') and (residual_signed &gt; 0) and (date_due &lt; current_date)
                            "
                    }</attribute>
                </xpath>

            </field>
        </record>

        <record id="view_account_payment_tree" model="ir.ui.view">
            <field name="name">account.payment.tree.gard_order_history</field>
            <field name="model">account.payment</field>
            <field name="view_mode">tree</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">

                <tree decoration-info="state=='draft'" decoration-muted="state=='reconciled'" edit="false">
                    <field name="state" widget="label_selection"
                        options="{
                            'classes': {
                                'draft': 'primary',
                                'open': 'warning',
                                'posted': 'success',
                                'reconciled': 'success',
                                'cancel': 'default'
                                }}"/>
                    <field name="payment_date"/>
                    <field name="partner_id" string="Partner"/>
                    <field name="name"/>
                    <field name="journal_id"/>
                    <field name="payment_method_id"/>
                    <field name="amount" sum="Amount"/>
                    <field name="communication"/>
                    <field name="transaction_number"/>
                    <field name="transaction_date"/>
                    <field name="currency_id" invisible="1"/>
                    <field name="partner_type" invisible="1"/>
                </tree>
                <!-- <kanban class="o_kanban_mobile" default_group_by="journal_type">
                    <field name="currency_id" invisible="1"/>
                    <field name="state"/>
                    <field name="payment_date"/>
                    <field name="partner_id"/>
                    <field name="name"/>
                    <field name="journal_code"/>
                    <field name="journal_type"/>
                    <field name="amount"/>
                    <field name="communication"/>
                    <field name="analytic_account_id"/>
                    <field name="move_name"/>
                    <field name="transaction_number"/>
                    <field name="transaction_date"/>
                    <field name="invoice_ids"/>
                    <field name="create_uid"/>
                    <templates>
                    <t t-name="kanban-box">
                        <div t-attf-class="oe_kanban_card oe_kanban_global_click">
                            <div class="row">
                                <div class="col-xs-6">
                                    <span>
                                        <t t-esc="record.journal_type.value"/> [<field name="journal_code"/>]
                                    </span>
                                    <br/>
                                    <strong><span><t t-esc="record.partner_id.value"/></span></strong>
                                    <br/>
                                    <br/>
                                    <strong><span><t t-esc="record.name.value"/></span></strong>
                                </div>
                                <div class="col-xs-6 pull-right text-right">
                                    <i class="fa fa-clock-o"/> <b><field name="payment_date"/></b>
                                    <br/>
                                    <i class="fa fa-money"/> <b><field name="amount" widget="monetary"/></b>
                                    <div class="o_kanban_tags_section">
                                        <field name="invoice_ids"/>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-6 text-muted">
                                    <span><t t-esc="record.communication.value"/></span>
                                </div>
                                <div class="col-xs-6 text-muted">
                                    <t t-if="record.journal_type.raw_value == 'bank'">
                                        <field name="bank_account_id"/>
                                        <br/>
                                        <field name="transaction_date"/>
                                        <br/>
                                        <b>[<field name="transaction_number"/>]</b>
                                    </t>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-6 text-muted">
                                    <span><t t-esc="record.analytic_account_id.value"/></span>
                                </div>
                                <br/>
                                <div class="col-xs-6 pull-right text-right text-muted">
                                    <span>
                                        <field name="state" widget="kanban_label_selection"
                                            options="{'classes': {'draft': 'default', 'posted': 'primary',
                                                'sent': 'danger', 'reconciled': 'success'}}"/>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </t>
                    </templates>
                </kanban> -->

            </field>
        </record>

        <!-- <record id="view_account_payment_kanban" model="ir.ui.view">
            <field name="name">account.payment.kanban.gard_order_history</field>
            <field name="model">account.payment</field>
            <field name="arch" type="xml">

                <kanban class="o_kanban_mobile">
                    <field name="currency_id" invisible="1"/>
                    <field name="state"/>
                    <field name="payment_date"/>
                    <field name="partner_id"/>
                    <field name="name"/>
                    <field name="journal_code"/>
                    <field name="journal_type"/>
                    <field name="amount"/>
                    <field name="communication"/>
                    <field name="analytic_account_id"/>
                    <field name="move_name"/>
                    <field name="transaction_number"/>
                    <field name="transaction_date"/>
                    <field name="invoice_ids"/>
                    <field name="create_uid"/>
                    <templates>
                    <t t-name="kanban-box">
                        <div t-attf-class="oe_kanban_card oe_kanban_global_click">
                            <div class="row">
                                <div class="col-xs-6">
                                    <span>[<t t-esc="record.journal_type.value"/>]</span>
                                    <br/>
                                    <strong><span><t t-esc="record.partner_id.value"/></span></strong>
                                    <br/>
                                    <br/>
                                    <strong><span><t t-esc="record.name.value"/></span></strong>
                                </div>
                                <div class="col-xs-6">
                                    <i class="fa fa-clock-o"/> <b><field name="payment_date"/></b>
                                    <br/>
                                    <i class="fa fa-money"/> <b><field name="amount" widget="monetary"/></b>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-6 text-muted">
                                    <span><t t-esc="record.communication.value"/></span>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-6 text-muted">
                                    <field name="journal_code"/>
                                    <br/>
                                    <span><t t-esc="record.analytic_account_id.value"/></span>
                                </div>
                                <br/>
                                <div class="col-xs-6 pull-right text-right text-muted">
                                    <span>
                                        <field name="state" widget="kanban_label_selection"
                                            options="{'classes': {'draft': 'default', 'posted': 'primary',
                                                'sent': 'danger', 'reconciled': 'success'}}"/>
                                    </span>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-xs-6 pull-right text-right text-muted">
                                    <t t-if="record.journal_type.raw_value == 'bank'">
                                        <field name="bank_account_id"/>
                                        <field name="transaction_date"/>
                                        <field name="transaction_number"/>
                                    </t>
                                </div>
                            </div>
                        </div>
                    </t>
                    </templates>
                </kanban>

            </field>
        </record> -->


    </data>
</openerp>
