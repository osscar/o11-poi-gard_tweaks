<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <!-- Search Views -->

  <!-- Form Views -->
  <record model="ir.ui.view" id="purchase_order_form">
    <field name="name">purchase.order.form.inherit.gard_x_propagate</field>
    <field name="model">purchase.order</field>
    <field name="mode">extension</field>
    <field name="priority">20</field>
    <field name="inherit_id" ref="purchase.purchase_order_form" />
    <field name="arch" type="xml">

      <!-- add fields -->
      <!-- notebook -->
      <xpath expr="//field[@name='order_line']" position="before">
        <div class="oe_button_box oe_left" name="button_box">
          <button name="%(action_propagate_product)d" type="action"
            attrs="{'invisible':['|',('state', '!=', 'draft')]}"
            icon="fa-cubes" string="Propagate Products" />
          <button name="%(action_propagate_account_analytic_create)d" type="action"
            attrs="{'invisible':[('state', '!=', 'draft')]}"
            icon="fa-plus-circle" string="Create Analytic Accounts" />
          <button name="button_unlink_order_line" type="object"
            attrs="{'invisible':['|',('state', '!=', 'draft'),('order_line', '=', [])]}"
            icon="fa-times" string="Clear Lines"
            confirm="This will clear all order lines. Are you sure you want to continue?" />
        </div>
      </xpath>

      <!-- order line -->
      <xpath expr="//field[@name='order_line']/tree//field[@name='account_analytic_id']"
        position="after">
        <button name="button_propagate_account_analytic" type="object"
          attrs="{'invisible':['|', ('account_analytic_id', '=', False), ('state', '!=', 'draft')]}"
          icon="fa-2x fa-list-ul" string="Propagate Analytic Accounts"
          confirm="This will propagate the analytic account to all order lines. Are you sure you want to continue?" />
      </xpath>

    </field>
  </record>

  <!-- Tree Views -->

  <!-- Actions -->

  <!-- Menus -->

</odoo>